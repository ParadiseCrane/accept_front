import { useLocale } from '@hooks/useLocale';
import { sendRequest } from '@requests/request';
import { Icon, Tip } from '@ui/basics';
import { openText } from '@utils/openText';
import { FC, ReactNode, memo, useCallback } from 'react';
import { Notes } from 'tabler-icons-react';

const OpenTestInNewTab: FC<{
  spec: string;
  field: 'input' | 'output';
  icon?: ReactNode;
}> = ({ spec, field, icon }) => {
  const onClick = useCallback(async () => {
    sendRequest<undefined, string>(`task_test/${field}/${spec}`, 'GET').then(
      (res) => {
        if (!res.error) openText(res.response);
      }
    );
  }, [field, spec]);
  const { locale } = useLocale();

  return (
    <>
      <Tip label={locale.newTab}>
        <Icon onClick={onClick} size="xs" color="var(--primary)">
          {icon ? icon : <Notes />}
        </Icon>
      </Tip>
    </>
  );
};

export default memo(OpenTestInNewTab);
